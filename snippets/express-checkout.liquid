{{ 'express-checkout.css' | asset_url | stylesheet_tag }}

{% assign checkout_id = 100 | rand: 2000 %}

{% style %}
  {% if is_sticky %}
    body {
      padding-bottom: 80px;
    }

    #express-checkout-form {
      display: none;
    }

  {% endif %}

  .custom-checkout-{{ checkout_id }},
  .express-checkout-fields,
  .sticky-form-wrapper {
    border-color: {{ settings.form_border_colour.hex }};
  }

  .custom-checkout-{{ checkout_id }} .express-checkout-fields,
  .sticky-form-wrapper .form-wrapper {
    grid-gap: {{ settings.inputs_gap }}px;
  }

  .custom-checkout-{{ checkout_id }} input, textarea {
    padding: {{ settings.input_padding }}px;
    border-radius: {{ settings.input_border_radius }}px;
    font-size: {{ settings.input_text_size }}px !important;

    {% if settings.input_background_color %}
    background-color: {{ settings.input_background_color.hex }};
    {% endif %}

    {% if settings.input_text_color %}
    color: {{ settings.input_text_color.hex }};
    {% endif %}

    {% if settings.input_border_color %}
    border-color: {{ settings.input_border_color.hex }};
    {% endif %}
  }

  .express-checkout-button {
    padding: {{ settings.button_padding }}px;
    border-radius: {{ settings.button_border_radius }}px;
    font-size: {{ settings.button_text_size }}px;
    color: {{ settings.button_text_color.hex }};

    {% if settings.button_background_color %}
    background-color: {{ settings.button_background_color.hex }} !important;
    {% endif %}
  }

  {% if settings.button_text_color %}
  .custom-checkout-{{ checkout_id }} button span {
    color: {{ settings.button_text_color.hex }} !important;
  }
  {% endif %}

  {% if settings.input_placeholder_color %}
  .custom-checkout-{{ checkout_id }} input::placeholder {
    color: {{ settings.input_placeholder_color.hex }};
  }
  {% endif %}

  .express-checkout-placeholder .express-checkout-button {
    opacity: 0.5;
    cursor: not-allowed;
  }
{% endstyle %}

<form 
  id='express-checkout-form'
   class='custom-checkout-{{ checkout_id }}
    {% if is_placeholder %}express-checkout-placeholder{% endif %}'
     onsubmit="return false;">
  <div class='express-checkout-fields'>
    <div class='express-checkout-title'>{{ settings.form_title }}</div>
    {%- for field in checkout.fields -%}
      <div class='express-checkout-field'>
        {%- if field.type == 'select' -%}
          <div class='dropdown-input'>
            <div class='dropbtn'>
              <span class='option-name'>{{ field.placeholder | default: 'Select option' }}</span>
              <ion-icon name='chevron-down-outline' class='dropdown-icon'></ion-icon>
            </div>
            <ul class='dropdown-content' name='{{ field.name }}'>
              {%- for option in field.options -%}
                <li value='{{ option }}'>{{ option }}</li>
              {%- endfor -%}
            </ul>
          </div>
        {%- elsif field.type == 'textarea' -%}
          <textarea id='{{ field.name }}' name='extra_fields[{{ field.name }}]' class='w-full' placeholder='{{ field.placeholder }}' {% if field.required %} required {% endif %}></textarea>
        {%- elsif field.type == 'number' -%}
          <input type='number' id='{{ field.name }}' name='extra_fields[{{ field.name }}]' class='w-full' placeholder='{{ field.placeholder }}' {% if field.required %} required {% endif %}>
        {%- else -%}
          <input type='{{ field.type }}' id='{{ field.name }}' name='{{ field.custom ? 'extra_fields[' : '' }}{{ field.name }}{{ field.custom ? ']' : '' }}' class='w-full' placeholder='{{ field.placeholder }}' {% if field.required %} required {% endif %}>
        {%- endif -%}
        <div class='validation-error' data-error='{{ field.custom ? 'extra_fields.' : '' }}{{ field.name }}'></div>
      </div>
    {%- endfor -%}

    {% if is_sticky == false %}
      <button
        type='submit'
        class='express-checkout-button'
        {% if is_placeholder %} disabled {% endif %}
        onclick='placeOrder(this)'>
        <span class='spinner hidden' id='loading__checkout'></span>
        <span>{{ settings.express_checkout_cta }}</span>
      </button>
    {% endif %}
  </div>
</form>

{{ 'express-checkout.js' | asset_url | script_tag_deferred }}
